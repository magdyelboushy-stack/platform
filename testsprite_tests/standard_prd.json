{
  "meta": {
    "project": "Educational Platform Authentication System",
    "date": "2026-01-21",
    "prepared_by": "Software Development Manager"
  },
  "product_overview": "A secure and user-friendly authentication system for an educational platform, enabling account registration, login, password recovery, and email verification while ensuring personal data protection and system integrity.",
  "core_goals": [
    "Provide a secure authentication flow for students and teachers.",
    "Enable open registration for students and admin-managed teacher accounts.",
    "Ensure robust password and email validation.",
    "Implement protection mechanisms including CSRF tokens, hashed passwords, HTTPS, and rate limiting.",
    "Enable password recovery and email verification with expiration handling.",
    "Maintain user session management with secure cookies.",
    "Deliver responsive and fault-tolerant system supporting concurrent users."
  ],
  "key_features": [
    "User registration with full name, email, and password validation following strict security rules.",
    "User login with credential verification and account lock after multiple failed attempts.",
    "Password recovery flow with secure reset link expiring in 15 minutes.",
    "Email verification post-registration with 24-hour expiration before feature access.",
    "CSRF token endpoint for requesting fresh tokens to prevent cross-site request forgery.",
    "Session-based authentication with secure, HttpOnly cookies.",
    "Security features including hashed passwords (bcrypt/Argon2), HTTPS enforcement, SQL Injection prevention, and rate limiting.",
    "Friendly and non-technical error messaging without revealing sensitive info.",
    "Internal logging of authentication errors for monitoring and auditing."
  ],
  "user_flow_summary": [
    "Student visits registration page, submits valid name, email, password, receives verification email.",
    "Student verifies email via link, account is activated for login.",
    "Student logs in using email and password, token/session is created, redirected to dashboard.",
    "If login fails 5 times, account is locked temporarily.",
    "User requests password reset by submitting registered email.",
    "User receives reset link, valid for 15 minutes, and submits new password.",
    "Teacher accounts are created only by admins; teachers log in using provided credentials.",
    "Admin can disable user accounts and manage access.",
    "CSRF tokens are fetched from the provided endpoint and submitted with all critical requests for security."
  ],
  "validation_criteria": [
    "User registration fails with invalid email or password not meeting security rules.",
    "Login fails with invalid credentials and locks account after 5 failed attempts.",
    "Password reset link expires after 15 minutes and cannot be reused.",
    "Verification email link expires after 24 hours, restricting unverified user access.",
    "CSRF token endpoint returns fresh tokens reliably.",
    "Passwords stored are hashed securely following recommended algorithms.",
    "All authentication-related endpoints enforce HTTPS and validate CSRF tokens.",
    "System handles concurrent users gracefully without performance degradation.",
    "Authentication errors are logged internally without exposing sensitive details to users.",
    "Login response times do not exceed 500 milliseconds under normal load."
  ],
  "code_summary": {
    "tech_stack": [
      "PHP",
      "Vite",
      "React",
      "TypeScript",
      "MySQL"
    ],
    "features": [
      {
        "name": "CSRF Token",
        "description": "Endpoint to get a fresh CSRF token for security.",
        "files": [
          "backend/app/Controllers/Security/CSRFController.php",
          "backend/app/Config/routes.php"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "CSRF API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/csrf-token": {
              "get": {
                "responses": {
                  "200": {
                    "description": "Returns a CSRF token",
                    "content": {
                      "application/json": {
                        "schema": {
                          "type": "object",
                          "properties": {
                            "csrf_token": {
                              "type": "string"
                            },
                            "message": {
                              "type": "string"
                            },
                            "session_id": {
                              "type": "string"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Auth Login",
        "description": "Endpoint for user login.",
        "files": [
          "backend/app/Controllers/Auth/Login.php",
          "backend/app/Config/routes.php"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Auth Login API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/auth/login": {
              "post": {
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "email": {
                            "type": "string"
                          },
                          "password": {
                            "type": "string"
                          },
                          "csrf_token": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "email",
                          "password",
                          "csrf_token"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "200": {
                    "description": "Login success"
                  },
                  "401": {
                    "description": "Unauthorized"
                  }
                }
              }
            }
          }
        }
      },
      {
        "name": "Auth Register",
        "description": "Endpoint for user registration.",
        "files": [
          "backend/app/Controllers/Auth/Register.php",
          "backend/app/Config/routes.php"
        ],
        "api_doc": {
          "openapi": "3.0.0",
          "info": {
            "title": "Auth Register API",
            "version": "1.0.0"
          },
          "paths": {
            "/api/auth/register": {
              "post": {
                "requestBody": {
                  "content": {
                    "application/json": {
                      "schema": {
                        "type": "object",
                        "properties": {
                          "name": {
                            "type": "string"
                          },
                          "email": {
                            "type": "string"
                          },
                          "password": {
                            "type": "string"
                          },
                          "csrf_token": {
                            "type": "string"
                          }
                        },
                        "required": [
                          "name",
                          "email",
                          "password",
                          "csrf_token"
                        ]
                      }
                    }
                  }
                },
                "responses": {
                  "201": {
                    "description": "User created"
                  },
                  "400": {
                    "description": "Bad Request"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
